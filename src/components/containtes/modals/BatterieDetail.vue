<template>
  <Transition>
    <div class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-[2px] z-50" v-if="show.showBatt"  @click="show.closeBattDetails">
      <div class="formModal" @click.stop >
        <div class="titre">
          <div class="title">
            <div class="icon">
              <i class="pi pi-bolt" style="font-size: 18px; color: #fff"></i>
            </div>
            <h3>Batterie {{ show.showBatterieItem }}</h3>
          </div>
          <div class="closeForm" @click="show.closeBattDetails">
            <i class="pi pi-times" style="font-size: 18px; color: #2d4051"></i>
          </div>
        </div>
        <div
          class="container"
          v-for="item in mqttStore.dataReceived"
          :key="item.id"
        >
          <div
            class="containerOne"
            v-if="item.batterie_id == show.showBatterieItemId"
          >
            <div class="item">
              <div class="cont">
                <h4>CHARGE</h4>
                <h5>En charge</h5>
              </div>
              <div class="progression">
                <div class="prog soc">
                  <Progression
                    :color="color1"
                    :unites="'%'"
                    :batteryId="show.showBatterieItemId"
                  />
                </div>
              </div>
            </div>

            <div class="item">
              <div class="cont">
                <h4>TENSION</h4>
                <h5>Normale</h5>
              </div>
              <div class="progression">
                <div class="prog">
                  <svg
                    fill="#000000"
                    width="30px"
                    height="64px"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                      id="SVGRepo_tracerCarrier"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></g>
                    <g id="SVGRepo_iconCarrier">
                      <path
                        d="M2 2V4H22V2H2ZM2 6V8H7V6H2ZM9 6V8H15V6H9ZM17 6V8H22V6H17Z"
                      ></path>
                      <path
                        d="M14.6 10.9H17L13.2 22H10.6L6.9 10.9H9.3L12 20L14.6 10.9Z"
                      ></path>
                    </g>
                  </svg>
                  <h1>{{ parseFloat(item.tension).toFixed(1) }}</h1>
                </div>
              </div>
            </div>
            <div class="item">
              <div class="cont">
                <h4>COURANT</h4>
                <h5>Normale</h5>
              </div>
              <div class="progression">
                <div class="prog">
                  <svg
                    fill="#000000"
                    width="30px"
                    height="30 px"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                      id="SVGRepo_tracerCarrier"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></g>
                    <g id="SVGRepo_iconCarrier">
                      <path
                        d="M2 2V4H22V2H2ZM2 6V8H7V6H2ZM9 6V8H15V6H9ZM17 6V8H22V6H17ZM14.8 22.1L14 19.5H10L9.2 22.1H6.7L10.6 11H13.5L17.4 22.1H14.8ZM13.5 17.5C13.4324 17.5 12 12.7 12 12.7L10.6 17.5H13.5Z"
                      ></path>
                    </g>
                  </svg>
                  <h1>{{ parseFloat(item.courant).toFixed(1) }}</h1>
                </div>
              </div>
            </div>
            <div class="item">
              <div class="cont">
                <h4>TEMPERATURE</h4>
                <h5
                  :style="{
                    backgroundColor: classifyTemperatureColor(
                      parseFloat(item.temperature).toFixed(1)
                    ),
                  }"
                >
                  {{
                    classifyTemperatureText(
                      parseFloat(item.temperature).toFixed(1)
                    )
                  }}
                </h5>
              </div>

              <div class="progression">
                <div class="prog">
                  <svg
                    v-if="see == '0'"
                    version="1.1"
                    id="_x35_"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    viewBox="0 0 512 512"
                    xml:space="preserve"
                    fill="#000000"
                  >
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                      id="SVGRepo_tracerCarrier"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></g>
                    <g id="SVGRepo_iconCarrier">
                      <g>
                        <g>
                          <g>
                            <rect
                              x="209.445"
                              y="21.061"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="93.246"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="45.123"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="69.185"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="117.308"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="141.37"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="165.432"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="237.617"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="189.494"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="213.555"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="261.679"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="285.741"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                          </g>
                          <g>
                            <path
                              style="fill: #34434c"
                              d="M293.996,30.094c-0.798,0-1.517,0.08-2.315,0.159l0.958-8.142h16.843v-9.819h-25.305 l-2.954,26.582c1.597-0.239,3.193-0.319,5.268-0.319c8.222,0,12.772,2.794,12.772,8.541c0,5.188-4.39,7.983-9.18,7.983 c-3.752,0-7.264-1.118-9.419-2.155l-2.076,9.02c2.475,1.277,7.185,2.474,12.294,2.474c12.852,0,20.355-8.461,20.355-18.2 C311.239,34.485,301.979,30.094,293.996,30.094z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,11.575c-12.293,0-17.641,12.054-17.641,26.582c0,12.852,4.31,26.262,17.402,26.262 c10.936,0,17.402-9.898,17.402-26.662C352.11,24.985,348.118,11.575,334.947,11.575z M334.867,54.92 c-3.752,0-5.667-5.268-5.667-16.923c0-11.655,2.155-17.003,5.667-17.003c3.672,0,5.349,5.987,5.349,17.003 C340.216,51.966,337.661,54.92,334.867,54.92z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M300.542,154.383v-0.16c5.348-2.156,8.541-6.386,8.541-11.655c0-6.945-5.428-12.692-15.566-12.692 c-5.588,0-11.016,1.676-13.73,3.353l2.315,8.541c1.916-1.198,5.269-2.554,8.541-2.554c4.231,0,6.466,2.235,6.466,5.348 c0,4.071-4.071,5.908-7.663,6.147h-3.831v8.302h3.432c4.949,0,9.499,2.315,9.499,7.424c0,3.911-2.954,6.945-8.222,6.945 c-3.672,0-7.743-1.437-9.659-2.634l-2.555,8.94c2.634,1.676,7.583,3.033,13.251,3.033c10.058,0,16.683-4.79,18.679-11.415 c0.399-1.357,0.639-2.794,0.639-4.231C310.68,160.29,306.13,155.739,300.542,154.383z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,129.876c-12.293,0-17.641,12.054-17.641,26.502c0,12.932,4.31,26.342,17.402,26.342 c10.936,0,17.402-9.898,17.402-26.662C352.11,143.287,348.118,129.876,334.947,129.876z M334.867,173.221 c-3.752,0-5.667-5.269-5.667-16.923c0-11.735,2.155-17.003,5.667-17.003c3.672,0,5.349,5.987,5.349,17.003 C340.216,170.268,337.661,173.221,334.867,173.221z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M293.677,248.816l-13.171,6.546l2.634,8.541l8.861-4.47h0.16v40.791h11.575v-51.408H293.677z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,248.097c-12.293,0-17.641,12.134-17.641,26.582c0,12.932,4.31,26.262,17.402,26.262 c10.936,0,17.402-9.818,17.402-26.582C352.11,261.588,348.118,248.097,334.947,248.097z M334.867,291.522 c-3.752,0-5.667-5.269-5.667-17.003c0-11.655,2.155-16.923,5.667-16.923c3.672,0,5.349,5.907,5.349,16.923 C340.216,288.489,337.661,291.522,334.867,291.522z"
                            ></path>
                          </g>
                        </g>
                        <path
                          style="fill: #34434c"
                          d="M235.804,394.098c0,65.138-52.765,117.902-117.902,117.902V0c9.898,0,19.238,2.395,27.54,6.706 c11.495,5.827,20.834,15.246,26.662,26.661c4.23,8.222,6.625,17.562,6.625,27.46v232.292 C212.894,313.714,235.804,351.232,235.804,394.098z"
                        ></path>
                        <path
                          style="fill: #455055"
                          d="M117.902,0v512c-13.889,0-27.22-2.395-39.593-6.785c-33.288-11.894-59.63-38.236-71.524-71.523 C2.395,421.319,0,407.987,0,394.098c0-42.866,22.91-80.384,57.075-100.979V60.827C57.075,27.38,84.455,0,117.902,0z"
                        ></path>
                        <path
                          style="fill: #30abf8"
                          d="M117.909,489.471c-52.585,0-95.365-42.78-95.365-95.365c0-33.716,17.265-64.264,46.181-81.717 l10.887-6.571V60.844c0-21.117,17.179-38.296,38.296-38.296c21.117,0,38.296,17.179,38.296,38.296v244.975l10.887,6.571 c28.918,17.454,46.183,48.003,46.183,81.717C213.276,446.691,170.494,489.471,117.909,489.471z"
                        ></path>
                        <path
                          style="fill: #f4f9f4"
                          d="M156.206,60.844v102.882H79.613V60.844c0-21.108,17.165-38.296,38.296-38.296 C139.018,22.547,156.206,39.736,156.206,60.844z"
                        ></path>
                        <path
                          style="opacity: 0.16; fill: #040000"
                          d="M213.268,394.106c0,52.579-42.779,95.358-95.358,95.358V22.547 c21.108,0,38.296,17.188,38.296,38.296v244.978l10.881,6.578C196.012,329.836,213.268,360.383,213.268,394.106z"
                        ></path>
                        <path
                          style="opacity: 0.16; fill: #040000"
                          d="M156.206,60.844v102.882H117.91V22.547C139.018,22.547,156.206,39.736,156.206,60.844z "
                        ></path>
                        <circle
                          style="fill: #2d7fd7"
                          cx="76.509"
                          cy="358.733"
                          r="29.013"
                        ></circle>
                        <circle
                          style="fill: #34434c"
                          cx="262.954"
                          cy="96.968"
                          r="9.943"
                        ></circle>
                        <circle
                          style="fill: #34434c"
                          cx="262.954"
                          cy="241.402"
                          r="9.943"
                        ></circle>
                      </g>
                    </g>
                  </svg>
                  <svg
                    v-if="see == '1'"
                    version="1.1"
                    id="_x35_"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    viewBox="0 0 512 512"
                    xml:space="preserve"
                    fill="#000000"
                  >
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                      id="SVGRepo_tracerCarrier"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></g>
                    <g id="SVGRepo_iconCarrier">
                      <g>
                        <g>
                          <g>
                            <rect
                              x="209.445"
                              y="21.061"
                              style="fill: #34434c"
                              width="30"
                              height="4.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="93.246"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="45.123"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="69.185"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="117.308"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="141.37"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="165.432"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="237.617"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="189.494"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="213.555"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="261.679"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="285.741"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                          </g>
                          <g>
                            <path
                              style="fill: #34434c"
                              d="M293.996,30.094c-0.798,0-1.517,0.08-2.315,0.159l0.958-8.142h16.843v-9.819h-25.305 l-2.954,26.582c1.597-0.239,3.193-0.319,5.268-0.319c8.222,0,12.772,2.794,12.772,8.541c0,5.188-4.39,7.983-9.18,7.983 c-3.752,0-7.264-1.118-9.419-2.155l-2.076,9.02c2.475,1.277,7.185,2.474,12.294,2.474c12.852,0,20.355-8.461,20.355-18.2 C311.239,34.485,301.979,30.094,293.996,30.094z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,11.575c-12.293,0-17.641,12.054-17.641,26.582c0,12.852,4.31,26.262,17.402,26.262 c10.936,0,17.402-9.898,17.402-26.662C352.11,24.985,348.118,11.575,334.947,11.575z M334.867,54.92 c-3.752,0-5.667-5.268-5.667-16.923c0-11.655,2.155-17.003,5.667-17.003c3.672,0,5.349,5.987,5.349,17.003 C340.216,51.966,337.661,54.92,334.867,54.92z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M300.542,154.383v-0.16c5.348-2.156,8.541-6.386,8.541-11.655c0-6.945-5.428-12.692-15.566-12.692 c-5.588,0-11.016,1.676-13.73,3.353l2.315,8.541c1.916-1.198,5.269-2.554,8.541-2.554c4.231,0,6.466,2.235,6.466,5.348 c0,4.071-4.071,5.908-7.663,6.147h-3.831v8.302h3.432c4.949,0,9.499,2.315,9.499,7.424c0,3.911-2.954,6.945-8.222,6.945 c-3.672,0-7.743-1.437-9.659-2.634l-2.555,8.94c2.634,1.676,7.583,3.033,13.251,3.033c10.058,0,16.683-4.79,18.679-11.415 c0.399-1.357,0.639-2.794,0.639-4.231C310.68,160.29,306.13,155.739,300.542,154.383z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,129.876c-12.293,0-17.641,12.054-17.641,26.502c0,12.932,4.31,26.342,17.402,26.342 c10.936,0,17.402-9.898,17.402-26.662C352.11,143.287,348.118,129.876,334.947,129.876z M334.867,173.221 c-3.752,0-5.667-5.269-5.667-16.923c0-11.735,2.155-17.003,5.667-17.003c3.672,0,5.349,5.987,5.349,17.003 C340.216,170.268,337.661,173.221,334.867,173.221z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M293.677,248.816l-13.171,6.546l2.634,8.541l8.861-4.47h0.16v40.791h11.575v-51.408H293.677z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,248.097c-12.293,0-17.641,12.134-17.641,26.582c0,12.932,4.31,26.262,17.402,26.262 c10.936,0,17.402-9.818,17.402-26.582C352.11,261.588,348.118,248.097,334.947,248.097z M334.867,291.522 c-3.752,0-5.667-5.269-5.667-17.003c0-11.655,2.155-16.923,5.667-16.923c3.672,0,5.349,5.907,5.349,16.923 C340.216,288.489,337.661,291.522,334.867,291.522z"
                            ></path>
                          </g>
                        </g>
                        <path
                          style="fill: #34434c"
                          d="M235.804,394.098c0,65.138-52.765,117.902-117.902,117.902V0c9.898,0,19.238,2.395,27.54,6.706 c11.495,5.827,20.834,15.246,26.662,26.661c4.23,8.222,6.625,17.562,6.625,27.46v232.292 C212.894,313.714,235.804,351.232,235.804,394.098z"
                        ></path>
                        <path
                          style="fill: #455055"
                          d="M117.902,0v512c-13.889,0-27.22-2.395-39.593-6.785c-33.288-11.894-59.63-38.236-71.524-71.523 C2.395,421.319,0,407.987,0,394.098c0-42.866,22.91-80.384,57.075-100.979V60.827C57.075,27.38,84.455,0,117.902,0z"
                        ></path>
                        <path
                          style="fill: #30f887"
                          d="M117.909,489.471c-52.585,0-95.365-42.78-95.365-95.365c0-33.716,17.265-64.264,46.181-81.717 l10.887-6.571V60.844c0-21.117,17.179-38.296,38.296-38.296c21.117,0,38.296,17.179,38.296,38.296v244.975l10.887,6.571 c28.918,17.454,46.183,48.003,46.183,81.717C213.276,446.691,170.494,489.471,117.909,489.471z"
                        ></path>
                        <path
                          style="fill: #f4f9f4"
                          d="M156.206,60.844v102.882H79.613V60.844c0-21.108,17.165-38.296,38.296-38.296 C139.018,22.547,156.206,39.736,156.206,60.844z"
                        ></path>
                        <path
                          style="opacity: 0.16; fill: #040000"
                          d="M213.268,394.106c0,52.579-42.779,95.358-95.358,95.358V22.547 c21.108,0,38.296,17.188,38.296,38.296v244.978l10.881,6.578C196.012,329.836,213.268,360.383,213.268,394.106z"
                        ></path>
                        <path
                          style="opacity: 0.16; fill: #040000"
                          d="M156.206,60.844v102.882H117.91V22.547C139.018,22.547,156.206,39.736,156.206,60.844z "
                        ></path>
                        <circle
                          style="fill: #0f763b"
                          cx="76.509"
                          cy="358.733"
                          r="29.013"
                        ></circle>
                        <circle
                          style="fill: #34434c"
                          cx="262.954"
                          cy="96.968"
                          r="9.943"
                        ></circle>
                        <circle
                          style="fill: #34434c"
                          cx="262.954"
                          cy="241.402"
                          r="9.943"
                        ></circle>
                      </g>
                    </g>
                  </svg>
                  <svg
                    v-if="see == '2'"
                    version="1.1"
                    id="_x35_"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    viewBox="0 0 512 512"
                    xml:space="preserve"
                    fill="#000000"
                  >
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                      id="SVGRepo_tracerCarrier"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></g>
                    <g id="SVGRepo_iconCarrier">
                      <g>
                        <g>
                          <g>
                            <rect
                              x="209.445"
                              y="21.061"
                              style="fill: #34434c"
                              width="30.326"
                              height="4.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="93.246"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="45.123"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="69.185"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="117.308"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="141.37"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="165.432"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="237.617"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="189.494"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="213.555"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="261.679"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="285.741"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                          </g>
                          <g>
                            <path
                              style="fill: #34434c"
                              d="M293.996,30.094c-0.798,0-1.517,0.08-2.315,0.159l0.958-8.142h16.843v-9.819h-25.305 l-2.954,26.582c1.597-0.239,3.193-0.319,5.268-0.319c8.222,0,12.772,2.794,12.772,8.541c0,5.188-4.39,7.983-9.18,7.983 c-3.752,0-7.264-1.118-9.419-2.155l-2.076,9.02c2.475,1.277,7.185,2.474,12.294,2.474c12.852,0,20.355-8.461,20.355-18.2 C311.239,34.485,301.979,30.094,293.996,30.094z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,11.575c-12.293,0-17.641,12.054-17.641,26.582c0,12.852,4.31,26.262,17.402,26.262 c10.936,0,17.402-9.898,17.402-26.662C352.11,24.985,348.118,11.575,334.947,11.575z M334.867,54.92 c-3.752,0-5.667-5.268-5.667-16.923c0-11.655,2.155-17.003,5.667-17.003c3.672,0,5.349,5.987,5.349,17.003 C340.216,51.966,337.661,54.92,334.867,54.92z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M300.542,154.383v-0.16c5.348-2.156,8.541-6.386,8.541-11.655c0-6.945-5.428-12.692-15.566-12.692 c-5.588,0-11.016,1.676-13.73,3.353l2.315,8.541c1.916-1.198,5.269-2.554,8.541-2.554c4.231,0,6.466,2.235,6.466,5.348 c0,4.071-4.071,5.908-7.663,6.147h-3.831v8.302h3.432c4.949,0,9.499,2.315,9.499,7.424c0,3.911-2.954,6.945-8.222,6.945 c-3.672,0-7.743-1.437-9.659-2.634l-2.555,8.94c2.634,1.676,7.583,3.033,13.251,3.033c10.058,0,16.683-4.79,18.679-11.415 c0.399-1.357,0.639-2.794,0.639-4.231C310.68,160.29,306.13,155.739,300.542,154.383z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,129.876c-12.293,0-17.641,12.054-17.641,26.502c0,12.932,4.31,26.342,17.402,26.342 c10.936,0,17.402-9.898,17.402-26.662C352.11,143.287,348.118,129.876,334.947,129.876z M334.867,173.221 c-3.752,0-5.667-5.269-5.667-16.923c0-11.735,2.155-17.003,5.667-17.003c3.672,0,5.349,5.987,5.349,17.003 C340.216,170.268,337.661,173.221,334.867,173.221z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M293.677,248.816l-13.171,6.546l2.634,8.541l8.861-4.47h0.16v40.791h11.575v-51.408H293.677z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,248.097c-12.293,0-17.641,12.134-17.641,26.582c0,12.932,4.31,26.262,17.402,26.262 c10.936,0,17.402-9.818,17.402-26.582C352.11,261.588,348.118,248.097,334.947,248.097z M334.867,291.522 c-3.752,0-5.667-5.269-5.667-17.003c0-11.655,2.155-16.923,5.667-16.923c3.672,0,5.349,5.907,5.349,16.923 C340.216,288.489,337.661,291.522,334.867,291.522z"
                            ></path>
                          </g>
                        </g>
                        <path
                          style="fill: #34434c"
                          d="M235.804,394.098c0,65.138-52.765,117.902-117.902,117.902V0c9.898,0,19.238,2.395,27.54,6.706 c11.495,5.827,20.834,15.246,26.662,26.661c4.23,8.222,6.625,17.562,6.625,27.46v232.292 C212.894,313.714,235.804,351.232,235.804,394.098z"
                        ></path>
                        <path
                          style="fill: #455055"
                          d="M117.902,0v512c-13.889,0-27.22-2.395-39.593-6.785c-33.288-11.894-59.63-38.236-71.524-71.523 C2.395,421.319,0,407.987,0,394.098c0-42.866,22.91-80.384,57.075-100.979V60.827C57.075,27.38,84.455,0,117.902,0z"
                        ></path>
                        <path
                          style="fill: #f83030"
                          d="M117.909,489.471c-52.585,0-95.365-42.78-95.365-95.365c0-33.716,17.265-64.264,46.181-81.717 l10.887-6.571V60.844c0-21.117,17.179-38.296,38.296-38.296c21.117,0,38.296,17.179,38.296,38.296v244.975l10.887,6.571 c28.918,17.454,46.183,48.003,46.183,81.717C213.276,446.691,170.494,489.471,117.909,489.471z"
                        ></path>
                        <path
                          style="fill: #f4f9f4"
                          d="M156.206,60.844v102.882H79.613V60.844c0-21.108,17.165-38.296,38.296-38.296 C139.018,22.547,156.206,39.736,156.206,60.844z"
                        ></path>
                        <path
                          style="opacity: 0.16; fill: #040000"
                          d="M213.268,394.106c0,52.579-42.779,95.358-95.358,95.358V22.547 c21.108,0,38.296,17.188,38.296,38.296v244.978l10.881,6.578C196.012,329.836,213.268,360.383,213.268,394.106z"
                        ></path>
                        <path
                          style="opacity: 0.16; fill: #040000"
                          d="M156.206,60.844v102.882H117.91V22.547C139.018,22.547,156.206,39.736,156.206,60.844z "
                        ></path>
                        <circle
                          style="fill: #750f19"
                          cx="76.509"
                          cy="358.733"
                          r="29.013"
                        ></circle>
                        <circle
                          style="fill: #34434c"
                          cx="262.954"
                          cy="96.968"
                          r="9.943"
                        ></circle>
                        <circle
                          style="fill: #34434c"
                          cx="262.954"
                          cy="241.402"
                          r="9.943"
                        ></circle>
                      </g>
                    </g>
                  </svg>
                  <svg
                    v-if="see == '3'"
                    version="1.1"
                    id="_x35_"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    viewBox="0 0 512 512"
                    xml:space="preserve"
                    fill="#000000"
                  >
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                      id="SVGRepo_tracerCarrier"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></g>
                    <g id="SVGRepo_iconCarrier">
                      <g>
                        <g>
                          <g>
                            <rect
                              x="209.445"
                              y="21.061"
                              style="fill: #34434c"
                              width="30.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="93.246"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="45.123"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="69.185"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="117.308"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="141.37"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="165.432"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="237.617"
                              style="fill: #34434c"
                              width="52.326"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="189.494"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="213.555"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="261.679"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                            <rect
                              x="209.445"
                              y="285.741"
                              style="fill: #34434c"
                              width="24.531"
                              height="8.744"
                            ></rect>
                          </g>
                          <g>
                            <path
                              style="fill: #34434c"
                              d="M293.996,30.094c-0.798,0-1.517,0.08-2.315,0.159l0.958-8.142h16.843v-9.819h-25.305 l-2.954,26.582c1.597-0.239,3.193-0.319,5.268-0.319c8.222,0,12.772,2.794,12.772,8.541c0,5.188-4.39,7.983-9.18,7.983 c-3.752,0-7.264-1.118-9.419-2.155l-2.076,9.02c2.475,1.277,7.185,2.474,12.294,2.474c12.852,0,20.355-8.461,20.355-18.2 C311.239,34.485,301.979,30.094,293.996,30.094z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,11.575c-12.293,0-17.641,12.054-17.641,26.582c0,12.852,4.31,26.262,17.402,26.262 c10.936,0,17.402-9.898,17.402-26.662C352.11,24.985,348.118,11.575,334.947,11.575z M334.867,54.92 c-3.752,0-5.667-5.268-5.667-16.923c0-11.655,2.155-17.003,5.667-17.003c3.672,0,5.349,5.987,5.349,17.003 C340.216,51.966,337.661,54.92,334.867,54.92z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M300.542,154.383v-0.16c5.348-2.156,8.541-6.386,8.541-11.655c0-6.945-5.428-12.692-15.566-12.692 c-5.588,0-11.016,1.676-13.73,3.353l2.315,8.541c1.916-1.198,5.269-2.554,8.541-2.554c4.231,0,6.466,2.235,6.466,5.348 c0,4.071-4.071,5.908-7.663,6.147h-3.831v8.302h3.432c4.949,0,9.499,2.315,9.499,7.424c0,3.911-2.954,6.945-8.222,6.945 c-3.672,0-7.743-1.437-9.659-2.634l-2.555,8.94c2.634,1.676,7.583,3.033,13.251,3.033c10.058,0,16.683-4.79,18.679-11.415 c0.399-1.357,0.639-2.794,0.639-4.231C310.68,160.29,306.13,155.739,300.542,154.383z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,129.876c-12.293,0-17.641,12.054-17.641,26.502c0,12.932,4.31,26.342,17.402,26.342 c10.936,0,17.402-9.898,17.402-26.662C352.11,143.287,348.118,129.876,334.947,129.876z M334.867,173.221 c-3.752,0-5.667-5.269-5.667-16.923c0-11.735,2.155-17.003,5.667-17.003c3.672,0,5.349,5.987,5.349,17.003 C340.216,170.268,337.661,173.221,334.867,173.221z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M293.677,248.816l-13.171,6.546l2.634,8.541l8.861-4.47h0.16v40.791h11.575v-51.408H293.677z"
                            ></path>
                            <path
                              style="fill: #34434c"
                              d="M334.947,248.097c-12.293,0-17.641,12.134-17.641,26.582c0,12.932,4.31,26.262,17.402,26.262 c10.936,0,17.402-9.818,17.402-26.582C352.11,261.588,348.118,248.097,334.947,248.097z M334.867,291.522 c-3.752,0-5.667-5.269-5.667-17.003c0-11.655,2.155-16.923,5.667-16.923c3.672,0,5.349,5.907,5.349,16.923 C340.216,288.489,337.661,291.522,334.867,291.522z"
                            ></path>
                          </g>
                        </g>
                        <path
                          style="fill: #34434c"
                          d="M235.804,394.098c0,65.138-52.765,117.902-117.902,117.902V0c9.898,0,19.238,2.395,27.54,6.706 c11.495,5.827,20.834,15.246,26.662,26.661c4.23,8.222,6.625,17.562,6.625,27.46v232.292 C212.894,313.714,235.804,351.232,235.804,394.098z"
                        ></path>
                        <path
                          style="fill: #455055"
                          d="M117.902,0v512c-13.889,0-27.22-2.395-39.593-6.785c-33.288-11.894-59.63-38.236-71.524-71.523 C2.395,421.319,0,407.987,0,394.098c0-42.866,22.91-80.384,57.075-100.979V60.827C57.075,27.38,84.455,0,117.902,0z"
                        ></path>
                        <path
                          style="fill: #f8b830"
                          d="M117.909,489.471c-52.585,0-95.365-42.78-95.365-95.365c0-33.716,17.265-64.264,46.181-81.717 l10.887-6.571V60.844c0-21.117,17.179-38.296,38.296-38.296c21.117,0,38.296,17.179,38.296,38.296v244.975l10.887,6.571 c28.918,17.454,46.183,48.003,46.183,81.717C213.276,446.691,170.494,489.471,117.909,489.471z"
                        ></path>
                        <path
                          style="fill: #f4f9f4"
                          d="M156.206,60.844v102.882H79.613V60.844c0-21.108,17.165-38.296,38.296-38.296 C139.018,22.547,156.206,39.736,156.206,60.844z"
                        ></path>
                        <path
                          style="opacity: 0.16; fill: #040000"
                          d="M213.268,394.106c0,52.579-42.779,95.358-95.358,95.358V22.547 c21.108,0,38.296,17.188,38.296,38.296v244.978l10.881,6.578C196.012,329.836,213.268,360.383,213.268,394.106z"
                        ></path>
                        <path
                          style="opacity: 0.16; fill: #040000"
                          d="M156.206,60.844v102.882H117.91V22.547C139.018,22.547,156.206,39.736,156.206,60.844z "
                        ></path>
                        <circle
                          style="fill: #d7902d"
                          cx="76.509"
                          cy="358.733"
                          r="29.013"
                        ></circle>
                        <circle
                          style="fill: #34434c"
                          cx="262.954"
                          cy="96.968"
                          r="9.943"
                        ></circle>
                        <circle
                          style="fill: #34434c"
                          cx="262.954"
                          cy="241.402"
                          r="9.943"
                        ></circle>
                      </g>
                    </g>
                  </svg>

                  <h1>{{ parseFloat(item.temperature).toFixed(1) }}</h1>
                </div>
              </div>
            </div>
          </div>
          <div
            class="containerTwo"
            v-if="item.batterie_id == show.showBatterieItemId"
          >
            <div class="option">
              <h4
                @click="show.setShowGraph('Tension')"
                :class="{
                  bg: show.showTension === true,
                }"
              >
                Tension
              </h4>
              <h4
                @click="show.setShowGraph('Courant')"
                :class="{
                  bg: show.showCourant === true,
                }"
              >
                Courant
              </h4>
              <h4
                @click="show.setShowGraph('TensionCourant')"
                :class="{
                  bg: show.showTensionCourant === true,
                }"
              >
                Tension/Courant
              </h4>
            </div>
            <div class="graph" v-show="show.showTension">
              <div class="containerG">
                <RealTimeChart
                  ref="tensionChart"
                  :chartWidth="'900px'"
                  :chartHeight="'360px'"
                  :batteryId="show.showBatterieItemId"
                  topic="batteries"
                  :color="colors.tensionColor"
                  :showTime="true"
                  :showTitle="false"
                  type="tension"
                />
              </div>
            </div>
            <div class="graph" v-show="show.showCourant">
              <div class="containerG">
                <RealTimeChart
                  ref="courantChart"
                  :chartWidth="'900px'"
                  :chartHeight="'360px'"
                  :batteryId="show.showBatterieItemId"
                  topic="batteries"
                  :color="colors.courantColor"
                  :showTime="true"
                  :showTitle="false"
                  type="courant"
                />
              </div>
            </div>
            <div class="graph" v-show="show.showTensionCourant">
              <div class="containerG">
                <RealTimeCurrentTensionChart
                  :chartWidth="'900px'"
                  :chartHeight="'360px'"
                  ref="tensionCourantChart"
                  :batteryId="show.showBatterieItemId"
                  topic="batteries"
                  :colorTension="colors.tensionColor"
                  :colorCourant="colors.courantColor"
                  :showTime="true"
                  :showTitle="false"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </Transition>
</template>

<script setup>
import { defineProps, onMounted, watch, nextTick, ref, computed } from "vue";
import { useShow } from "@/stores/show";
import { colors } from "@/service/color";
const show = useShow();
const color1 = "rgb(2, 200, 2)";
import { useProgressStore } from "@/stores/progress";
const store = useProgressStore();
import Progression from "@/components/containtes/chart/Progression.vue";
import RealTimeCurrentTensionChart from "@/components/containtes/chart/RealTimeCurrentTensionChart.vue";
import RealTimeChart from "@/components/containtes/chart/RealTimeChart.vue";
const props = defineProps({
  batteryIdBat: Number,
});
import { useMqttStore } from "@/stores/mqttStore";
const mqttStore = useMqttStore();
const see = ref();
// Fonction pour classifier les températures en couleurs
const classifyTemperatureColor = (temperature) => {
  if (temperature < 10) {
    return colors.tensionColor; // Température Basse
  } else if (temperature >= 10 && temperature <= 40) {
    return "#58fb60"; // Température Normale
  } else if (temperature > 40 && temperature <= 60) {
    return "orange"; // Température Élevée
  } else {
    return "red"; // Température Critique
  }
}; // Fonction pour classifier les températures en texte
const classifyTemperatureText = (temperature) => {
  if (temperature < 10) {
    see.value = "0";
    return "Basse";
  } else if (temperature >= 10 && temperature <= 40) {
    see.value = "1";
    return "Normale";
  } else if (temperature > 40 && temperature <= 60) {
    see.value = "2";
    return "Élevée";
  } else {
    see.value = "3";
    return "Critique";
  }
};

// Watch for changes in the showGraph value and resize the chart accordingly
watch(
  () => show.showGraph,
  async () => {
    await nextTick();
    if (show.showTension) {
      this.$refs.tensionChart.chartInstance.resize();
    } else if (show.showCourant) {
      this.$refs.courantChart.chartInstance.resize();
    } else if (show.showTensionCourant) {
      this.$refs.tensionCourantChart.chartInstance.resize();
    }
  }
);
</script>

<style scoped>
.closeForm {
  background-color: #fb7b5891;
  width: 40px;
  height: 40px;
  border-radius: 100%;

  align-items: center;
  display: flex;
  justify-content: center;
}


.closeForm:hover {
  background-color: #f76a44ab;
  cursor: pointer;
}

.showModal {
  position: fixed;
  top: 0;
  width: 100%;
  background-color: rgba(92, 90, 90, 0.927);
  z-index: 2;
  width: 100%;
  height: 100%;
  display: flex;
  background: rgba(43, 38, 38, 0.801);
  justify-content: center;
  align-items: center;
}

.formModal {
  width: 70%;
  /* height: 550px; */
  background-color: #fff;
  border-radius: 10px;
  padding: 20px;
}

.icon {
  width: 25px;
  height: 25px;
  border-radius: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #fb7a58;
  margin-right: 10px;
}
.titre {
  padding: 5px 10px;
  background-color: #dddddd78;
  display: flex;
  align-items: center;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.title {
  display: flex;
}
.titre h3 {
  font-weight: 600;
}
.container {
  width: 100%;
  /* display: flex;
  align-items: center;
  justify-content: space-around; */
}
.containerOne {
  width: 100%;
  display: flex;
  justify-content: space-between;
  /* height: 100%; */
  padding-top: 10px;
}
.item {
  background-color: #e9f0f67d;
  /* margin-bottom: 2px; */
  display: flex;
  justify-content: space-around;
  align-items: center;
  border-radius: 5px;
  /* background-color: red; */
  width: 23%;
  height: 100px;
}
.cont {
  width: 45%;
  /* height: 100px; */
  text-align: center;
  /* background-color: blue; */
}
.cont h4 {
  font-weight: 600;
  padding: 10px;
  font-size: 10px;
}

.cont h5 {
  font-weight: 600;
  padding: 5px;
  background-color: #58fb60;
  border-radius: 5px;
  font-size: 11px;
}
.progression {
  width: 40%;
  height: 50px;
  /* padding: 5px; */
  text-align: center;
  /* background-color: rgb(0, 38, 255); */
}

.progression h4 {
  font-weight: 600;
  color: rgb(2, 200, 2);
  background-color: rgba(13, 255, 0, 0.402);
  border-radius: 3px;
}
.prog {
  /* width: 100%; */
  height: 50px;
  background-color: #38b2b225;
  padding: 5px;
  border-radius: 5px;
  display: flex;
  /* text-align: center; */
  justify-content: space-around;
  align-content: center;
  align-items: center;

  box-shadow: 0px 2px 5px rgb(189, 189, 189);
}

.prog h1 {
  display: block;
  align-self: center;
  margin: auto 0;
  width: 100%;
  font-weight: 600;
}

.temp {
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
}
.temperature {
  height: 100px;
  align-items: center;
  display: flex;
  justify-content: center;
  margin: 0 auto;
  background-color: #dfe2e285;
  padding: 5px;
  border-radius: 5px;
  box-shadow: 0px 2px 5px rgb(189, 189, 189);
}
.temp h4 {
  font-weight: 600;
  color: #fb7a58;
  background-color: #fc8d6e52;
  border-radius: 3px;
}

.containerTwo {
  width: 100%;
  height: 60vh;
  /* background-color: red; */
}
.option {
  display: flex;
  justify-content: space-around;
  width: 50%;
  position: relative;
  left: 283px;
  top: 2px;
  margin-top: 10px;
}
.graph {
  /* background-color: #d430d4; */
  width: 95%;
  height: 340px !important;
  margin: 0 auto;
  height: 65vh;
  border: 2px solid #c7c7c72d;
  border-radius: 5px;
  display: flex;
  align-items: center;
  /* /
  Batterie 01
  PARC 01
  36%
  En Charge
  22°C
  Température
  Détails
  Batterie 02
  PARC 01
  36%
  En Charge
  59°C
  Température
  Détails
  Batterie 01 */
  
}
.containerG {
  width: 100%;
  height: 100%;
  margin: 0 auto;
  /* background-color: rgb(47, 255, 0); */
  display: flex;
  align-items: center;
  justify-content: center;
}
.bg {
  background-color: #e9f0f6;
  border-bottom: 2px solid #e9f0f6;
  border-top: 2px solid #c7c7c72d;
  border-left: 2px solid #c7c7c72d;
  border-right: 2px solid #c7c7c72d;
  border-radius: 5px 5px 0px 0px;
}
.option h4 {
  padding: 5px;
  font-size: 12px;
  cursor: pointer;
}
</style>
